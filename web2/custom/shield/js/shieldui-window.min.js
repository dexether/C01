/* Shield UI 1.7.3 Trial Version | Copyright 2013-2014 Shield UI Ltd. | www.shieldui.com/eula */
!function(a,b,c,d){"use strict";var l,h,g=b.ui.Widget,j=(b.Class,b.Constants,b.format),p=document,f=(a.extend,a.map,a.each,a.proxy),k=b.error,m=b.is["boolean"],u=b.is.object,s=b.is.defined,r=(b.to.number,"close"),w="minimize",q="maximize",o="resize",n="scroll",t="pin",i="overflow",v="hidden",e="px";l={title:"",titleBarButtons:["pin","minimize","maximize","close"],content:d,cls:d,visible:!0,pinned:!1,modal:!1,width:400,height:300,resizable:{maxWidth:d,maxHeight:d,minWidth:200,minHeight:150},draggable:!0,position:d,appendToBody:!1,events:{}},h=g.extend({init:function(){g.fn.init.apply(this,arguments),s(this.initialOptions.titleBarButtons)&&(this.options.titleBarButtons=this.initialOptions.titleBarButtons);var x,w,r,d=this,i=d.options,t=i.cls,v=i.titleBarButtons,q=i.resizable,n=i.draggable,l=i.content,o=i.position,h=a(d.element);return"div"!==a(h).prop("tagName").toLowerCase()?void k("shieldWindow: Underlying element is not DIV",i.dieOnError):v&&v.length>0&&!b.ui.Button?void k("shieldWindow: The titleBarButtons setting requires ShieldUI Button to be loaded",i.dieOnError):(i.appendToBody?(h.appendTo(p.body),d._parentIsBody=!0):d._parentIsBody="body"==h.parent().prop("tagName").toLowerCase(),d._origHtml=h.html(),h.empty(),h.addClass("sui-window"+(t?" "+t:"")),r={width:i.width+e,height:i.height+e,position:"absolute"},h.css(r),d.titleBarEl=x=a('<div class="sui-window-titlebar"><div class="sui-window-title">'+i.title+'</div><div class="sui-window-icons"></div></div>').appendTo(h),d._initTitleBarButtons(),d.contentEl=w=a('<div class="sui-window-content"></div>').appendTo(h),d._fixContent(),o&&u(o)||(o=b.ui.Position.GetCenter(h,d._parentIsBody?c:h.parent())),h.css(o),q&&(m(q)&&(q={}),d.resizable=new b.ui.Resizable(h,q),d.resizable.on("resized",f(d._fixContent,d))),n&&(m(n)&&(n={}),n.target=d.titleBarEl,d.draggable=new b.ui.Draggable(h,n)),d._hasIframe=!1,l?l.template?l.template.dataUrl?a.ajax({url:l.template.dataUrl,dataType:"json",success:function(a){d.content(j(l.template.body,a))},error:function(c,a,b){d.content("Error occured while reading URL: "+a+" - "+b)}}):d.content(j(l.template.body,l.template.data)):l.remote?l.remote.iframe?(d._hasIframe=!0,d.content('<iframe class="sui-window-iframe" src="'+l.remote.url+'" style="border:none; border-width:0px; width:100%; height:100%;"></iframe>')):d.contentEl.load(l.remote.url):d.content(d._origHtml):d.content(d._origHtml),d.pinned(!!i.pinned),d.visible(i.visible),d._minimized=!1,void(d._maximized=!1))},_initTitleBarButtons:function(){var g,h,b,d,c=this,i=c.options,e=i.titleBarButtons,j=i.modal;if(c.titleBarButtons={},e&&e.length>0){for(g=c.titleBarEl.find(".sui-window-icons"),d=0;d<e.length;d++)b=e[d],("pin"===b||"minimize"===b||"maximize"===b||"close"===b)&&(j&&"close"!==b||(h="pin"==b?"_onPin":"minimize"==b?"_onMinimize":"maximize"==b?"_onMaximize":b,c.titleBarButtons[b]=a('<button><div class="sui-window-button-icon sui-window-button-icon-'+b+'"></div></button>').appendTo(g).shieldButton({cls:"sui-window-button",events:{click:f(c[h],c,!0)}}).swidget()));g.on("mousedown",function(a){return a.preventDefault(),a.stopPropagation(),!1})}},_destroyTitleBarButtons:function(){var a,c=this,b=c.titleBarButtons;for(a in b)b.hasOwnProperty(a)&&b[a].destroy();c.titleBarButtons={}},_createModal:function(){var b=this,d=a(b._parentIsBody?c:b.element.parent()),e=a(d).scrollTop(),f=a(d).scrollLeft();b._lockScroll(),b._modal=a('<div class="sui-window-modal"></div>').insertBefore(b.element).css({top:e,left:f})},_closeModal:function(){var b=this;a(b._modal).remove(),b._unlockScroll()},_lockScroll:function(){var b=this,c=b.element.parent();b._scrollTop=a(c).scrollTop(),b._scrollLeft=a(c).scrollLeft(),b._parentOverflow=a(c).css(i),c.css(i,v).scrollTop(b._scrollTop).scrollLeft(b._scrollLeft)},_unlockScroll:function(){var a=this,b=a.element.parent();b.css(i,a._parentOverflow).scrollTop(a._scrollTop).scrollLeft(a._scrollLeft)},_fixContent:function(){var b=this;a(b.contentEl).innerHeight(a(b.element).innerHeight()-a(b.titleBarEl).outerHeight()),b._hasIframe&&a(b.contentEl).find(".sui-window-iframe").outerHeight(a(b.element).innerHeight()-a(b.titleBarEl).outerHeight())},center:function(){var d=this,e=a(d.element);b.ui.Position.Center(e,d._parentIsBody?c:e.parent())},position:function(b){a(this.element).css(b)},content:function(){var d=this,b=a(d.contentEl),c=[].slice.call(arguments);return c.length>0?(b.empty(),void b.append(c)):b.html()},resize:function(b){a(this.element).css(b),this._fixContent()},_scroll:function(){var b=this,d=a(b.element),f=b._parentIsBody;b._pinned&&d.css({left:b.originalPosition.left+a(f?c:d.parent()).scrollLeft()+e,top:b.originalPosition.top+a(f?c:d.parent()).scrollTop()+e})},_onPin:function(a){this.pinned(!this._pinned,a)},pinned:function(){var d,h,b=this,e=[].slice.call(arguments),g=a(b.element),i=b._parentIsBody,j=b.titleBarEl,k=j.find(j.find(".sui-window-button-icon-pin").length>0?".sui-window-button-icon-pin":".sui-window-button-icon-unpin");return e.length<=0?b._pinned:(d=!!e[0],void(b._pinned!=d&&(e[1]&&(h=b.trigger(t,{pinned:d}),h.isDefaultPrevented())||(b._pinned=d,k.removeClass("sui-window-button-icon-pin sui-window-button-icon-unpin"),k.addClass(b._pinned?"sui-window-button-icon-pin":"sui-window-button-icon-unpin"),b._pinned?(b.originalPosition=g.position(),b._scrollProxy=f(b._scroll,b),a(i?c:g.parent()).on(n,b._scrollProxy),b.draggable&&b.draggable.enabled(!1)):(a(i?c:g.parent()).off(n,b._scrollProxy),b._scrollProxy=b.origininalPosition=null,b.draggable&&b.draggable.enabled(!0))))))},_onMinimize:function(a){this.minimized(!0,a)},minimized:function(){var d,c,h,b=this,e=[].slice.call(arguments),f=a(b.element),i=a(b.contentEl),g=b.titleBarEl,j=b.titleBarButtons.minimize;return e.length<=0?b._minimized:(c=!!e[0],void(b._minimized!=c&&(e[1]&&(h=b.trigger(w,{minimized:c}),h.isDefaultPrevented())||(b._minimized=c,d=g.find(g.find(".sui-window-button-icon-minimize").length>0?".sui-window-button-icon-minimize":".sui-window-button-icon-unminimize"),d.removeClass("sui-window-button-icon-minimize sui-window-button-icon-unminimize"),d.addClass(b._minimized?"sui-window-button-icon-unminimize":"sui-window-button-icon-minimize"),c?(b._onMinCurrHeight=f.height(),f.height(g.height()),i.hide(),b.resizable&&b.resizable.enabled(!1)):(f.height(b._onMinCurrHeight),i.show(),b.resizable&&b.resizable.enabled(!0)),j&&j.visible(!c)))))},_onMaximize:function(b){var a=this;a._minimized?a.minimized(!1,b):a.maximized(!a._maximized,b)},maximized:function(){var g,j,h,k,b=this,i=[].slice.call(arguments),d=a(b.element),e=b._beforeMaximize,l=a(b.titleBarEl);return i.length>0?(g=!!i[0],j=!!i[1],b._minimized&&b.minimized(!1,!1),b._maximized!=g&&(j&&(k=b.trigger(q,{maximized:g}),k.isDefaultPrevented())||(b._maximized=!!g,h=l.find(l.find(".sui-window-button-icon-maximize").length>0?".sui-window-button-icon-maximize":".sui-window-button-icon-restore"),h.removeClass("sui-window-button-icon-maximize sui-window-button-icon-restore"),h.addClass(b._maximized?"sui-window-button-icon-restore":"sui-window-button-icon-maximize"),b._maximized?(b._beforeMaximize={top:d.css("top"),left:d.css("left"),width:d.width(),height:d.height()},b.resize({width:"100%",height:a(b._parentIsBody?c:d.parent()).height()}),b._lockScroll(),b.center(),b._parentIsBody&&(b._winResizeMax=f(b._onWinResizeMax,b),a(c).on(o,b._winResizeMax))):(e&&(d.css({top:e.top,left:e.left}),b.resize({width:e.width,height:e.height})),b._unlockScroll(),b._parentIsBody&&(a(c).off(o,b._winResizeMax),b._winResize=null)))),void 0):b._maximized},_onWinResizeMax:function(){var b=this;a(b.element).height(a(c).height()),b._fixContent()},close:function(c){var a,b=this;c&&(a=b.trigger(r),a.isDefaultPrevented())||b.destroy()},visible:function(){var a=this,b=[].slice.call(arguments);return b.length>0&&a.options.modal&&(b[0]?a._createModal():a._closeModal()),g.fn.visible.apply(a,arguments)},destroy:function(){var b=this,c=b.options.cls;b.visible(!1),b.resizable&&(b.resizable.destroy(),b.resizable=null),b.draggable&&(b.draggable.destroy(),b.draggable=null),b._destroyTitleBarButtons(),b.maximized(!1),b.pinned(!1),a(b.element).removeClass("sui-window"+(c?" "+c:"")),b._origHtml&&(a(b.element).html(b._origHtml),b._origHtml=null),g.fn.destroy.call(b)}}),h.defaults=l,b.ui.plugin("Window",h)}(jQuery,shield,this);